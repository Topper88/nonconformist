<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>п o п c o п f o r m i s t | The Trees Bear Music v0.6.1</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body { margin:0; overflow:hidden; background:#000; font-family:'Courier New',monospace; }
  #info { position:absolute; top:20px; left:20px; color:#ddd; background:rgba(0,0,0,0.6); padding:15px; border-radius:12px; max-width:340px; backdrop-filter:blur(10px); z-index:10; border:1px solid #334; }
  #info a { color:#8cf; }
  .tooltip { position:absolute; background:rgba(20,20,40,0.95); color:#fff; padding:10px 16px; border-radius:10px; font-size:14px; pointer-events:none; opacity:0; transition:opacity .3s; z-index:100; backdrop-filter:blur(12px); border:1px solid #556; }
  .album-panel { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); background:rgba(15,15,35,0.98); color:#fff; padding:30px; border-radius:20px; width:380px; box-shadow:0 0 60px rgba(100,180,255,0.5); display:none; z-index:200; backdrop-filter:blur(16px); border:1px solid #667; }
  .close-btn { position:absolute; top:12px; right:16px; font-size:28px; cursor:pointer; color:#aaa; }
  .close-btn:hover { color:#fff; }
  #cc { position:absolute; bottom:20px; right:20px; color:#666; font-size:11px; z-index:10; }
  #cc a { color:#8cf; text-decoration:none; }
</style>
<script src="https://cdn.jsdelivr.net/npm/three@0.134.0/build/three.min.js"></script>
</head>
<body>

<div id="info">
  <strong>п o п c o п f o r m i s t</strong><br>
  <em>The Trees Bear Music v0.6.1</em><br><br>
  Drag to orbit • Scroll to zoom • Click a chest for playlist<br>
  Click a fruit for track • Let the monument breathe<br>
  <a href="https://ko-fi.com/nnconformist" target="_blank">Tip if it moves you</a>
</div>
<div class="tooltip" id="tooltip"></div>
<div id="cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></div>

<div id="album-panel" class="album-panel">
  <div class="close-btn">×</div>
  <h3 id="album-title"></h3>
  <img id="album-art" width="100%" style="border-radius:12px; margin:16px 0;">
  <div id="player-container"></div>
</div>

<script>
  const scene = new THREE.Scene();
  scene.fog = new THREE.FogExp2(0x0a1a2f, 0.0008);
  const camera = new THREE.PerspectiveCamera(60, innerWidth/innerHeight, 0.1, 1000);
  const renderer = new THREE.WebGLRenderer({ antialias:true });
  renderer.setSize(innerWidth, innerHeight);
  renderer.setPixelRatio(devicePixelRatio);
  document.body.appendChild(renderer.domElement);

  // Sky + stars
  scene.background = new THREE.Color(0x0a0a1f);
  const stars = new THREE.Points(
    new THREE.BufferGeometry().setAttribute('position', new THREE.Float32BufferAttribute(Array.from({length:9000},()=>THREE.MathUtils.randFloatSpread(2000)),3)),
    new THREE.PointsMaterial({color:0xffffff,size:1.2})
  );
  scene.add(stars);

  scene.add(new THREE.AmbientLight(0x404060, 0.9));
  const moon = new THREE.DirectionalLight(0xaaccff, 1.4);
  moon.position.set(30,50,20);
  scene.add(moon);

  const ground = new THREE.Mesh(new THREE.PlaneGeometry(800,800), new THREE.MeshStandardMaterial({color:0x0a1a0a, roughness:1}));
  ground.rotation.x = -Math.PI/2;
  ground.position.y = -1;
  scene.add(ground);

  // CENTRAL STONEHENGE
  const stonehenge = new THREE.Group();
  const stoneMat = new THREE.MeshStandardMaterial({color:0x777777, roughness:0.95});
  const left = new THREE.Mesh(new THREE.BoxGeometry(3,12,3), stoneMat);
  left.position.set(-6,6,0);
  const right = new THREE.Mesh(new THREE.BoxGeometry(3,12,3), stoneMat);
  right.position.set(6,6,0);
  const lintel = new THREE.Mesh(new THREE.BoxGeometry(15,3,3.5), stoneMat);
  lintel.position.set(0,13,0);
  stonehenge.add(left,right,lintel);

  const aura = new THREE.Mesh(new THREE.SphereGeometry(12,32,16), new THREE.MeshBasicMaterial({color:0x88ccff, transparent:true, opacity:0.2}));
  aura.position.y = 7;
  stonehenge.add(aura);
  scene.add(stonehenge);

  // ORBIT CONTROLS
  let radius = 70;
  let theta = 0;
  let phi = Math.PI / 3.5;
  let isDragging = false;
  let previousMouse = { x: 0, y: 0 };

  const updateCamera = () => {
    camera.position.x = radius * Math.sin(phi) * Math.cos(theta);
    camera.position.y = radius * Math.cos(phi);
    camera.position.z = radius * Math.sin(phi) * Math.sin(theta);
    camera.lookAt(0, 6, 0);
  };
  updateCamera();

  renderer.domElement.addEventListener('pointerdown', e => {
    isDragging = true;
    previousMouse = { x: e.clientX, y: e.clientY };
  });
  renderer.domElement.addEventListener('pointermove', e => {
    if (isDragging) {
      const deltaX = e.clientX - previousMouse.x;
      const deltaY = e.clientY - previousMouse.y;
      theta -= deltaX * 0.005;
      phi += deltaY * 0.005;
      phi = Math.max(0.1, Math.min(Math.PI - 0.1, phi));
      previousMouse = { x: e.clientX, y: e.clientY };
      updateCamera();
    }
  });
  renderer.domElement.addEventListener('pointerup', () => isDragging = false);
  renderer.domElement.addEventListener('wheel', e => {
    radius += e.deltaY * 0.05;
    radius = Math.max(30, Math.min(150, radius));
    updateCamera();
  });

  // FRUIT SHAPES AND COLORS
  const fruitShapes = [
    new THREE.SphereGeometry(0.6, 8, 6),
    new THREE.SphereGeometry(0.7, 10, 8),
    new THREE.ConeGeometry(0.5, 1.2, 8),
    new THREE.ConeGeometry(0.4, 1.4, 8),
    new THREE.BoxGeometry(0.7, 1.1, 0.7),
    new THREE.TorusGeometry(0.4, 0.15, 6, 12)
  ];
  const fruitColors = [0xff3366, 0x33ff99, 0xffaa00, 0xcc33ff, 0xffff33, 0x33ccff, 0xff6666, 0x66ff33, 0xff33cc, 0x33ff66];

  // ALBUMS WITH PLAYLISTS AND TRACKS
  const albums = [
    {playlist: "https://soundcloud.com/musique_residentielle/sets/wisdom-box", tracks: ["https://soundcloud.com/musique_residentielle/wb_01", "https://soundcloud.com/musique_residentielle/wb_02", "https://soundcloud.com/musique_residentielle/wb_03", "https://soundcloud.com/musique_residentielle/wb_04", "https://soundcloud.com/musique_residentielle/wb_05", "https://soundcloud.com/musique_residentielle/wb_06", "https://soundcloud.com/musique_residentielle/wb_07", "https://soundcloud.com/musique_residentielle/wb_08", "https://soundcloud
